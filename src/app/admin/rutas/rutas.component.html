<div class="rutas-page">
  <h2 class="page-title">Rutas</h2>

  <section class="actions">
    <a class="btn btn-primary" routerLink="/admin/rutas/editor">ğŸ—ºï¸ Crear desde mapa</a>
  </section>

  <section class="listado">
    <details class="collapsible" open>
      <summary>
        <span class="section-title">Listado</span>
        <span class="count">{{ rutas().length }}</span>
        <span class="caret" aria-hidden>â–¾</span>
      </summary>
      @if (listLoading()) {
        <div class="loading">Cargando...</div>
      } @else {
        <div class="list">
          @for (r of pagedRutas(); track r.id) {
            <div class="item card">
              <div class="row">
                <div class="col">
                  <div class="title">{{ r.nombre }}</div>
                  <div class="subtitle">Actualizada: {{ r.updated_at || 'â€”' }}</div>
                </div>
                <div class="col small actions">
                  <a class="btn btn-ghost" [routerLink]="['/admin/rutas/editor']" [queryParams]="{ id: r.id }">Editar</a>
                  <button class="btn btn-ghost danger" (click)="eliminar(r.id)" [disabled]="loading()">Eliminar</button>
                </div>
              </div>
            </div>
          }
          @if (rutas().length === 0) {
            <div class="empty">Sin rutas</div>
          }
        </div>
        <div class="pagination">
          <button class="btn btn-ghost" (click)="prevPage()" [disabled]="page() === 1">Â« Anterior</button>
          <div class="pages">
            @for (p of pagesWindow(); track p) {
              <button class="page-btn" [class.active]="p === page()" (click)="gotoPage(p)">{{ p }}</button>
            }
          </div>
          <button class="btn btn-ghost" (click)="nextPage()" [disabled]="page() === totalPages()">Siguiente Â»</button>
          <div class="page-text">Pag {{ page() }} de {{ totalPages() }}</div>
        </div>
      }
    </details>
  </section>
</div>
